---
title: "单机->分布式"
date: 2021-10-02T04:06:19+08:00
draft: true
toc: true
images:
tags: 
  - distributed
---

记录分布式由单机发展到分布式集群的一些驱动因素和存在的问题，十一回家路上看了一夜，凌晨四点到家编辑一下。。。

## 单机模式

所有应用程序和数据均部署在一台电脑或服务器上，由一台计算机完成所有的处理。

单机模式，性能受限，存在单点失效问题

## 数据并行/分布模式

解决单机模式存在的问题，出现了并行计算。

并行计算采用**消息共享模式**使用**多台计算机并行运行或执行多项任务**，核心原理是每台计算机上执行相同的程序，将**数据进行拆分**放到不同的计算机上进行计算。

将应用和数据分离，多个应用进程处理一份数据或者把数据再进行拆分，针对不同的数据进行并行处理。

这样就可以利用多台应用处理更多的请求，可以解决单机的计算性能瓶颈，但是无法提供请求的性能、降低时延。

### 需要处理的点

- 大量请求需要负载均衡到多台应用上【需要负载均衡器以及链路追踪】
- 请求量大时，数据库IO又成为了新的瓶颈【数据库采取主从方案，保证数据同步一致性达到读写分离的效果】
- 热点数据，数据库压力依然很大【将热点数据进行缓存】

### 耗时请求依然耗时

**数据分布并行模式可以解决性能问题，耗时复杂的请求依然是耗时的，对提升单个任务的执行性能及降低时延无效。**

## 数据并行/分布模式

任务并行指的是，将**单个复杂的任务拆分为多个子任务**，从而使得多个子任务可以在不同的计算机上并行执行，提高单个耗时复杂的请求计算速度。

设计、拆分比较复杂，需要做到可拓展和可维护管理。

## 分布式

分布式就是**将相同或相关的程序运行在多台计算机上，从而实现特定目标的一种计算方式**。

产生分布式的最主要驱动力量，是对于性能、可用性及可扩展性的不懈追求。最终的实现就是用更多的机器处理更多的数据和任务。

## 指标

### 性能指标

指标在一定的标准下得到的平均值进行对比或者统计来看才有意义。

- 吞吐量（Throughput）一定时间内可以处理的任务数，
  - QPS 每秒查询数，通常对应读操作
  - TPS 每秒事务数，通常对应写操作
  - BPS 每秒比特，体现每秒处理的数据量

- 响应时间（Response Time），系统响应一个请求或输入的时间，主要体现在时延

- 完成时间（Turnaround Time），系统真正处理完成一个请求花费的时间，任务并行的目的就是缩短任务的时间。

### 资源占用

Resource Usage，提供正常能力所需要的资源。

- 空载资源占用 没有任何负载时候的占用
- 满载资源占用 全力运行时占用的资源

### 可用性

Availability，系统在面对各种异常时可以正确提供服务的能力，衡量了系统的鲁棒性，是系统容错能力的体现。

可以用系统停止服务的时间与总的时间之比衡量，或者某功能的失败次数与总的请求次数之比来衡量。

**可用性允许部分组件失效，系统仍然能够提供服务。**

### 可靠性

Reliability，系统完全不出故障的概率，多用在硬件设备。

### 可拓展性

Scalability，分布式系统**通过拓展集群机器规模**提高系统性能(吞吐量、相应时间、完成时间)、存储容量、计算能力的特性，是分布式系统的特有特质。

分布式系统设计的初衷就是利用集群多机器的能力处理单机无法解决的问题，**集群规模取决于单个机器的性能和任务的要求**。

当任务的需求随着具体业务不断提高时，除了**升级系统的性能**做垂直/纵向拓展外(提供单机配置)，另一个做法就是通过**增加机器**的水平去水平/横向拓展系统规模。

最好的分布式系统总是在追求“**线性拓展性**”，某一个指标可以随着集群中机器数量呈线性增长。就像一辆跑车，气缸越多/缸径越小，功率越高，长时间的线性提速体验肯定是要优于短暂的涡轮增压提速，涡轮增压式的提速有一点 Long Tail 的意思。

衡量系统可拓展性的常见指标是**加速比(Speedup)**，也就是拓展后相对拓展前的性能提升，就像跑车的加速度，根据拓展的目标来对比，比如 吞吐量、完成任务时间。

